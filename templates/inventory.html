{% extends "index.html" %}

{% block title %}Inventory{% endblock %}

{% block content %}
{% set category_colors = {
    'Bibs': 'bg-primary',
    'Jerseys': 'bg-warning text-dark',
    'Shorts': 'bg-danger',
    'Gloves': 'bg-success',
    'Helmets': 'bg-info text-dark',
    'Raw Materials': 'bg-secondary',
    'Accessories': 'bg-dark'
} %}

<div class="container mt-4 p-4">
<h2 class="mb-4 text">
    <i class="bi bi-box-seam"></i> Inventory Overview</h2>

<!-- Search & Filter Form -->
<form method="GET" action="{{ url_for('inventory') }}" class="row g-3 mb-4">
  <div class="col-md-4">
    <label for="searchInput" class="form-label" style="color: #0d6efd;">Search Inventory</label>
    <div class="input-group border rounded">
      <span class="input-group-text"><i class="bi bi-search"></i></span>
      <input type="text" name="search" value="{{ request.args.get('search', '') }}" class="form-control" id="searchInput" placeholder="Search by name or description">
    </div>
  </div>

  <div class="col-md-3">
    <label for="categoryFilter" class="form-label" style="color: #0d6efd;">Category</label>
    <select class="form-select" name="category" id="categoryFilter">
      <option value="">All Categories</option>
      <option value="Bibs" {% if request.args.get('category') == 'Bibs' %}selected{% endif %}>Cycling Bibs</option>
      <option value="Jerseys" {% if request.args.get('category') == 'Jerseys' %}selected{% endif %}>Cycling Jerseys</option>
      <option value="Shorts" {% if request.args.get('category') == 'Shorts' %}selected{% endif %}>Cycling Shorts</option>
      <option value="Gloves" {% if request.args.get('category') == 'Gloves' %}selected{% endif %}>Cycling Gloves</option>
      <option value="Helmets" {% if request.args.get('category') == 'Helmets' %}selected{% endif %}>Cycling Helmets</option>
      <option value="Accessories" {% if request.args.get('category') == 'Accessories' %}selected{% endif %}>Cycling Accessories</option>
      <option value="Raw Materials" {% if request.args.get('category') == 'Raw Materials' %}selected{% endif %}>Raw Materials</option>
    </select>
  </div>

  <div class="col-md-3">
    <label for="stockFilter" class="form-label" style="color: #0d6efd;">Stock Status</label>
    <select class="form-select" name="stock" id="stockFilter">
      <option value="">All Items</option>
      <option value="in-stock" {% if request.args.get('stock') == 'in-stock' %}selected{% endif %}>In Stock</option>
      <option value="low-stock" {% if request.args.get('stock') == 'low-stock' %}selected{% endif %}>Low Stock</option>
      <option value="out-of-stock" {% if request.args.get('stock') == 'out-of-stock' %}selected{% endif %}>Out of Stock</option>
    </select>
  </div>

  <div class="col-md-2">
    <label class="form-label">&nbsp;</label>
    <div class="d-grid">
      <button type="submit" class="btn btn-outline-primary"><i class="bi bi-funnel me-1"></i>Filter</button>
    </div>
  </div>
</form>

<div class="mb-3">
  <a href="/inventory/add" class="btn btn-primary mb-3">
    <i class="bi bi-plus-circle"></i> Add New Item</a>
</div>

<table class="table table-striped table-hover" id="inventoryTable">
  <thead class="table-dark">
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Description</th>
            <th>Category</th>
            <th>Supplier</th>
            <th>Unit Price</th>
            <th>Reorder Level</th>
            <th>Total Stock</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
    {% for item in items %}
    <tr>
        <td>{{ item['item_id'] }}</td>
        <td>{{ item['item_name'] }}</td>
        <td>{{ item['description'] }}</td>
        <td><span class="badge {{ category_colors[item['category_name']] }}">{{ item['category_name'] }}</span></td>
        <td>{{ item['supplier_name'] }}</td>
        <td>{{ item['unit_price'] }}</td>
        <td>{{ item['reorder_level'] }}</td>
        <td>{{ item['total_stock'] }}</td>
        <td>
            <div class="d-flex gap-1">
              <a href="/inventory/edit/{{ item['item_id'] }}" class="btn btn-sm btn-primary me-1">
                <i class="bi bi-pencil-square"></i></a>
              <a href="/inventory/delete/{{ item['item_id'] }}" class="btn btn-sm btn-danger" onclick="return confirm('Are you sure?')">
                <i class="bi bi-trash"></i></a>
            </div>
        </td>
    </tr>
    {% endfor %}
    </tbody>
</table>
</div>
{% endblock %}